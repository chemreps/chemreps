from chemreps.bagger import BagMaker
from chemreps.bat import bat
import numpy as np
import pytest as pt
from collections import OrderedDict


def test_bat():
    bags_true = OrderedDict([('C', 16), ('CC', 120), ('CCC', 11), ('CCCC', 8), ('CCCH', 25), ('CCCN', 4),
                             ('CCCO', 5), ('CCCS', 2), ('CCH',
                                                        23), ('CCN', 7), ('CCNC', 4), ('CCNH', 3),
                             ('CCO', 7), ('CCOC', 1), ('CCOH',
                                                       1), ('CCS', 4), ('CH', 288), ('CNC', 4),
                             ('CNCC', 7), ('CNCH', 5), ('CNCO',
                                                        3), ('CNCS', 2), ('CNH', 2), ('COC', 1),
                             ('COCC', 2), ('COCH', 2), ('COH',
                                                        1), ('CSC', 1), ('CSCC', 4), ('CSCH', 1),
                             ('CSCN', 1), ('H', 18), ('HCCH',
                                                      16), ('HCCN', 5), ('HCCO', 7), ('HCCS', 8),
                             ('HCH', 8), ('HCN', 3), ('HCNH',
                                                      1), ('HCO', 2), ('HCS', 1), ('HH', 153),
                             ('HNCO', 1), ('HOCO', 1), ('HOH',
                                                        1), ('N', 2), ('NC', 32), ('NCCN', 2),
                             ('NCCO', 4), ('NCCS', 2), ('NCO',
                                                        2), ('NCS', 1), ('NH', 36), ('NN', 1),
                             ('O', 5), ('OC', 80), ('OCCO',
                                                    1), ('OCO', 1), ('OH', 90), ('ON', 10),
                             ('OO', 10), ('S', 1), ('SC', 16), ('SH', 18), ('SN', 2), ('SO', 5)])

    bat_true = np.array([36.84, 36.84, 36.84, 36.84,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0., 23.38, 23.38, 23.33, 14.15,
                         14.15,  9.195,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  1.943,  1.943,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  3.14,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  3.14,  3.14,
                         1.051,  1.051,  1.051,  1.051,  1.029,  1.029,  1.029,
                         1.029,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  1.932,  1.932,  1.932,  1.932,
                         1.924,  1.924,  1.915,  1.915,  1.915,  1.915,  1.906,
                         1.906,  1.906,  1.906,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  5.492,  5.492,
                         5.492,  5.492,  5.492,  5.492,  5.492,  5.492,  5.492,
                         5.492,  2.775,  2.775,  2.775,  2.775,  2.762,  2.762,
                         2.762,  2.762,  2.76,  2.76,  2.752,  2.752,  2.752,
                         2.752,  2.162,  2.162,  2.162,  2.162,  2.145,  2.145,
                         2.145,  2.145,  1.717,  1.717,  1.42,  1.42,  1.42,
                         1.42,  1.272,  1.272,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,
                         0.5,  0.5,  0.5,  0.5,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  3.14,
                         3.14,  3.115,  3.115,  3.115,  3.115,  1.083,  1.083,
                         1.066,  1.066,  1.066,  1.066,  1.024,  1.024,  1.024,
                         1.024,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  1.8955,  1.8955,  1.891,
                         1.891,  1.891,  1.89,  1.877,  1.877,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.567,  0.567,  0.565,  0.565,
                         0.565,  0.565,  0.5635,  0.5635,  0.4016,  0.4016,  0.4016,
                         0.4016,  0.3982,  0.3982,  0.3982,  0.3982,  0.3975,  0.3975,
                         0.387,  0.387,  0.387,  0.387,  0.3254,  0.3254,  0.3254,
                         0.3254,  0.3254,  0.3254,  0.3193,  0.3193,  0.3193,  0.3193,
                         0.265,  0.265,  0.265,  0.2646,  0.2256,  0.2256,  0.2095,
                         0.2095,  0.2041,  0.2041,  0.2041,  0.2041,  0.1781,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,
                         0.,  0.,  0.,  0.,  0.,  0.,  0.,        0.], dtype=np.float16)

    bagger = BagMaker("BAT", "data/sdf/")
    assert bagger.bag_sizes == bags_true

    rep = bat("data/sdf/butane.sdf", bagger.bags, bagger.bag_sizes)
    assert np.all(np.abs(bat_true - rep) <= 1e-4) == True

    rep = bat("data/cml/butane.cml", bagger.bags, bagger.bag_sizes)
    assert np.all(np.abs(bat_true - rep) <= 1e-4) == True

    with pt.raises(NotImplementedError):
        rep = bat("data/xyz/butane.xyz", bagger.bags, bagger.bag_sizes)

    with pt.raises(NotImplementedError):
        bagger = BagMaker("BAT", "data/xyz/")

    pen_bat_true = np.array([3.6844e+01, 3.6844e+01, 3.6844e+01, 3.6844e+01, 3.6844e+01,
                             3.6844e+01, 3.6844e+01, 3.6844e+01, 3.6844e+01, 3.6844e+01,
                             3.6844e+01, 3.6844e+01, 3.6844e+01, 3.6844e+01, 3.6844e+01,
                             3.6844e+01, 0.0000e+00, 2.5938e+01, 2.5938e+01, 2.5812e+01,
                             2.5812e+01, 2.5812e+01, 2.5812e+01, 2.4078e+01, 2.3781e+01,
                             2.3547e+01, 2.3453e+01, 2.3453e+01, 2.3344e+01, 2.3312e+01,
                             1.7172e+01, 1.5133e+01, 1.4977e+01, 1.4977e+01, 1.4898e+01,
                             1.4898e+01, 1.4898e+01, 1.4898e+01, 1.4414e+01, 1.4336e+01,
                             1.4336e+01, 1.4297e+01, 1.4180e+01, 1.4016e+01, 1.3898e+01,
                             1.3641e+01, 1.2969e+01, 1.2961e+01, 1.2906e+01, 1.2906e+01,
                             1.2312e+01, 1.1016e+01, 1.0766e+01, 1.0703e+01, 1.0578e+01,
                             1.0141e+01, 1.0062e+01, 1.0016e+01, 9.9922e+00, 9.9453e+00,
                             9.4297e+00, 9.4219e+00, 9.3438e+00, 9.0078e+00, 8.6797e+00,
                             8.4766e+00, 8.1094e+00, 7.8711e+00, 7.8164e+00, 7.7305e+00,
                             7.5977e+00, 7.5977e+00, 7.5352e+00, 7.3555e+00, 7.2617e+00,
                             7.1836e+00, 6.6367e+00, 6.5234e+00, 6.4414e+00, 6.1367e+00,
                             5.9219e+00, 5.7344e+00, 5.7148e+00, 5.7109e+00, 5.7031e+00,
                             5.5391e+00, 5.5234e+00, 5.3398e+00, 5.3047e+00, 5.0938e+00,
                             5.0703e+00, 5.0312e+00, 4.8750e+00, 4.8477e+00, 4.8008e+00,
                             4.6680e+00, 4.6016e+00, 4.4219e+00, 4.3945e+00, 4.3477e+00,
                             4.1797e+00, 4.1758e+00, 4.1719e+00, 4.1523e+00, 4.1445e+00,
                             4.1289e+00, 4.0664e+00, 4.0664e+00, 3.9922e+00, 3.8652e+00,
                             3.8281e+00, 3.7891e+00, 3.7051e+00, 3.6973e+00, 3.6484e+00,
                             3.6465e+00, 3.6289e+00, 3.6113e+00, 3.6055e+00, 3.5781e+00,
                             3.5723e+00, 3.5508e+00, 3.4863e+00, 3.3008e+00, 3.2754e+00,
                             3.2656e+00, 3.2617e+00, 3.2500e+00, 3.2031e+00, 3.1992e+00,
                             3.1953e+00, 3.1641e+00, 3.1621e+00, 2.9668e+00, 2.9297e+00,
                             2.9102e+00, 2.8965e+00, 0.0000e+00, 2.1113e+00, 2.0938e+00,
                             2.0938e+00, 2.0938e+00, 2.0859e+00, 2.0859e+00, 2.0117e+00,
                             1.9990e+00, 1.9443e+00, 1.9209e+00, 1.4990e+00, 0.0000e+00,
                             1.6230e+00, 5.7031e-01, 2.7370e-04, 2.4211e-04, 1.9526e-04,
                             1.3578e-04, 8.5235e-05, 5.6922e-05, 0.0000e+00, 3.1406e+00,
                             3.1406e+00, 3.1406e+00, 3.1406e+00, 3.1406e+00, 3.1406e+00,
                             3.1348e+00, 3.1348e+00, 3.1113e+00, 3.1113e+00, 3.1055e+00,
                             3.1035e+00, 3.0488e+00, 3.0098e+00, 2.7246e+00, 1.9990e+00,
                             1.2002e+00, 1.1514e+00, 1.0850e+00, 1.0674e+00, 1.0059e+00,
                             9.9902e-01, 9.4189e-01, 8.9844e-01, 5.3027e-01, 0.0000e+00,
                             2.5762e+00, 1.5146e+00, 3.8223e-03, 3.5610e-03, 0.0000e+00,
                             3.1406e+00, 3.1406e+00, 3.0156e+00, 2.0176e+00, 1.1250e+00,
                             0.0000e+00, 2.6172e+00, 1.8057e+00, 0.0000e+00, 2.1406e+00,
                             2.1055e+00, 2.0957e+00, 2.0938e+00, 2.0938e+00, 2.0938e+00,
                             2.0938e+00, 2.0938e+00, 2.0918e+00, 2.0566e+00, 2.0254e+00,
                             1.9834e+00, 1.9590e+00, 1.9521e+00, 1.9482e+00, 1.9463e+00,
                             1.9443e+00, 1.9434e+00, 1.9414e+00, 1.9404e+00, 1.8926e+00,
                             1.8809e+00, 1.8506e+00, 0.0000e+00, 2.0508e+00, 1.9893e+00,
                             1.9609e+00, 1.8760e+00, 1.8701e+00, 1.5889e+00, 1.5283e+00,
                             0.0000e+00, 2.7617e+00, 2.2656e+00, 1.8066e+00, 4.0321e-03,
                             0.0000e+00, 1.3262e+00, 3.8867e-01, 9.6512e-03, 0.0000e+00,
                             2.3711e+00, 2.1816e+00, 2.1465e+00, 2.0859e+00, 2.0859e+00,
                             1.9316e+00, 1.9307e+00, 0.0000e+00, 2.6152e+00, 0.0000e+00,
                             3.1406e+00, 0.0000e+00, 2.0371e+00, 1.9023e+00, 1.8838e+00,
                             1.8096e+00, 0.0000e+00, 5.5234e+00, 5.5234e+00, 5.5234e+00,
                             5.5234e+00, 5.5234e+00, 5.4844e+00, 5.4766e+00, 5.4766e+00,
                             5.4766e+00, 5.4766e+00, 5.4727e+00, 5.4727e+00, 5.4727e+00,
                             5.4648e+00, 5.4609e+00, 5.4609e+00, 3.0820e+00, 2.8945e+00,
                             2.8555e+00, 2.8477e+00, 2.8184e+00, 2.8164e+00, 2.7871e+00,
                             2.7852e+00, 2.7852e+00, 2.7852e+00, 2.7852e+00, 2.7852e+00,
                             2.7852e+00, 2.7852e+00, 2.7773e+00, 2.7578e+00, 2.7520e+00,
                             2.7480e+00, 2.7461e+00, 2.7422e+00, 2.7422e+00, 2.7363e+00,
                             2.7305e+00, 2.7285e+00, 2.7090e+00, 2.6758e+00, 2.4082e+00,
                             2.3672e+00, 2.3672e+00, 2.3379e+00, 2.3105e+00, 2.2930e+00,
                             2.2383e+00, 2.2168e+00, 2.1816e+00, 2.1816e+00, 2.1719e+00,
                             2.1680e+00, 2.1582e+00, 2.1543e+00, 2.1309e+00, 2.1074e+00,
                             2.0938e+00, 2.0723e+00, 2.0527e+00, 2.0469e+00, 2.0273e+00,
                             2.0020e+00, 1.9756e+00, 1.9043e+00, 1.8896e+00, 1.8877e+00,
                             1.8604e+00, 1.8535e+00, 1.8174e+00, 1.7725e+00, 1.7705e+00,
                             1.7695e+00, 1.7656e+00, 1.7646e+00, 1.7646e+00, 1.7646e+00,
                             1.7646e+00, 1.7637e+00, 1.7578e+00, 1.7236e+00, 1.7227e+00,
                             1.7139e+00, 1.7119e+00, 1.6973e+00, 1.6738e+00, 1.6094e+00,
                             1.5742e+00, 1.5703e+00, 1.5693e+00, 1.5537e+00, 1.5488e+00,
                             1.5488e+00, 1.5488e+00, 1.5479e+00, 1.5430e+00, 1.5322e+00,
                             1.5225e+00, 1.5215e+00, 1.5166e+00, 1.4971e+00, 1.4932e+00,
                             1.4883e+00, 1.4717e+00, 1.4492e+00, 1.4492e+00, 1.4424e+00,
                             1.4355e+00, 1.4316e+00, 1.4258e+00, 1.4199e+00, 1.4062e+00,
                             1.3848e+00, 1.3799e+00, 1.3750e+00, 1.3564e+00, 1.3330e+00,
                             1.3311e+00, 1.2920e+00, 1.2910e+00, 1.2861e+00, 1.2754e+00,
                             1.2676e+00, 1.2588e+00, 1.2588e+00, 1.2520e+00, 1.2490e+00,
                             1.2451e+00, 1.2451e+00, 1.2393e+00, 1.2246e+00, 1.1826e+00,
                             1.1748e+00, 1.1631e+00, 1.1572e+00, 1.1514e+00, 1.1484e+00,
                             1.1367e+00, 1.1299e+00, 1.1279e+00, 1.1250e+00, 1.1133e+00,
                             1.1064e+00, 1.1025e+00, 1.0938e+00, 1.0928e+00, 1.0918e+00,
                             1.0771e+00, 1.0742e+00, 1.0723e+00, 1.0547e+00, 1.0361e+00,
                             1.0273e+00, 1.0059e+00, 9.9951e-01, 9.9756e-01, 9.9658e-01,
                             9.9121e-01, 9.8584e-01, 9.8389e-01, 9.8340e-01, 9.7754e-01,
                             9.6680e-01, 9.5996e-01, 9.5654e-01, 9.4531e-01, 9.4141e-01,
                             9.3848e-01, 9.0820e-01, 9.0723e-01, 8.9453e-01, 8.8867e-01,
                             8.7842e-01, 8.7695e-01, 8.6230e-01, 8.5791e-01, 8.5742e-01,
                             8.5547e-01, 8.5400e-01, 8.5059e-01, 8.4961e-01, 8.4473e-01,
                             8.2324e-01, 8.1689e-01, 8.0566e-01, 8.0225e-01, 7.9785e-01,
                             7.9102e-01, 7.7832e-01, 7.7393e-01, 7.7002e-01, 7.6367e-01,
                             7.6025e-01, 7.5586e-01, 7.5391e-01, 7.3975e-01, 7.3926e-01,
                             7.3828e-01, 7.2705e-01, 7.2607e-01, 7.2363e-01, 7.2266e-01,
                             7.1826e-01, 7.1484e-01, 7.1289e-01, 7.1289e-01, 6.9629e-01,
                             6.9336e-01, 6.8555e-01, 6.6895e-01, 6.6602e-01, 6.5869e-01,
                             6.5771e-01, 6.5381e-01, 6.4697e-01, 6.4258e-01, 6.3818e-01,
                             6.3330e-01, 6.3232e-01, 6.2354e-01, 6.2207e-01, 6.2158e-01,
                             6.1523e-01, 6.1426e-01, 6.1182e-01, 6.1035e-01, 6.0205e-01,
                             6.0010e-01, 5.9814e-01, 5.9766e-01, 5.9717e-01, 5.9521e-01,
                             5.9033e-01, 5.8984e-01, 5.8936e-01, 5.8691e-01, 5.8643e-01,
                             5.8496e-01, 5.7666e-01, 5.7471e-01, 5.7275e-01, 5.7080e-01,
                             5.6592e-01, 5.6396e-01, 5.6201e-01, 5.5957e-01, 5.5859e-01,
                             5.5713e-01, 5.5371e-01, 5.5322e-01, 5.4688e-01, 5.4688e-01,
                             5.4492e-01, 5.2930e-01, 5.2832e-01, 5.2734e-01, 5.2734e-01,
                             5.2441e-01, 5.2197e-01, 5.1855e-01, 5.1660e-01, 5.0879e-01,
                             5.0684e-01, 5.0391e-01, 5.0244e-01, 5.0049e-01, 4.9976e-01,
                             4.9707e-01, 4.9512e-01, 4.9390e-01, 4.9170e-01, 4.9170e-01,
                             4.9048e-01, 4.8511e-01, 4.8462e-01, 4.8413e-01, 4.8389e-01,
                             4.6216e-01, 4.5972e-01, 4.5972e-01, 4.5776e-01, 4.5386e-01,
                             4.5142e-01, 4.5068e-01, 4.4800e-01, 4.2554e-01, 4.2456e-01,
                             0.0000e+00, 2.1855e+00, 2.1465e+00, 2.0781e+00, 1.6670e+00,
                             0.0000e+00, 3.1406e+00, 2.3730e+00, 2.3145e+00, 2.3008e+00,
                             1.8447e+00, 1.4111e-01, 4.0092e-03, 0.0000e+00, 2.0508e+00,
                             1.9551e+00, 1.8643e+00, 5.3613e-01, 1.6882e-01, 0.0000e+00,
                             3.0215e+00, 7.2461e-01, 1.1826e-04, 0.0000e+00, 2.0371e+00,
                             3.3105e-01, 0.0000e+00, 2.0840e+00, 2.0527e+00, 0.0000e+00,
                             2.0449e+00, 0.0000e+00, 2.6172e+00, 5.2344e-01, 0.0000e+00,
                             1.5820e+00, 5.5371e-01, 0.0000e+00, 1.9541e+00, 0.0000e+00,
                             1.5918e+00, 0.0000e+00, 2.7070e+00, 2.1895e+00, 1.4912e+00,
                             6.3525e-01, 0.0000e+00, 1.6143e+00, 0.0000e+00, 5.4736e-01,
                             0.0000e+00, 5.0000e-01, 5.0000e-01, 5.0000e-01, 5.0000e-01,
                             5.0000e-01, 5.0000e-01, 5.0000e-01, 5.0000e-01, 5.0000e-01,
                             5.0000e-01, 5.0000e-01, 5.0000e-01, 5.0000e-01, 5.0000e-01,
                             5.0000e-01, 5.0000e-01, 5.0000e-01, 5.0000e-01, 0.0000e+00,
                             5.1880e-02, 2.2430e-02, 5.3482e-03, 1.2465e-03, 7.2956e-04,
                             0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
                             0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
                             0.0000e+00, 0.0000e+00, 2.2773e+00, 1.9824e+00, 1.9434e+00,
                             1.0547e+00, 1.0059e+00, 0.0000e+00, 2.1348e+00, 2.0879e+00,
                             2.0762e+00, 1.2812e+00, 1.0635e+00, 3.1403e-02, 1.4579e-04,
                             0.0000e+00, 3.1367e+00, 3.0781e+00, 2.5312e+00, 1.5117e+00,
                             1.1064e+00, 1.0625e+00, 1.0430e+00, 1.0059e+00, 0.0000e+00,
                             1.9199e+00, 1.8809e+00, 1.8799e+00, 1.8730e+00, 1.8721e+00,
                             1.8682e+00, 1.8604e+00, 0.0000e+00, 0.0000e+00, 1.9697e+00,
                             1.9541e+00, 1.8691e+00, 0.0000e+00, 2.6152e+00, 0.0000e+00,
                             1.9561e+00, 1.9121e+00, 0.0000e+00, 2.0215e+00, 0.0000e+00,
                             5.6885e-01, 5.6738e-01, 5.6689e-01, 5.6641e-01, 5.6494e-01,
                             5.6445e-01, 5.5664e-01, 4.3286e-01, 4.1772e-01, 4.1528e-01,
                             4.1016e-01, 4.0894e-01, 4.0723e-01, 4.0356e-01, 4.0308e-01,
                             4.0308e-01, 4.0039e-01, 3.8916e-01, 3.8843e-01, 3.8062e-01,
                             3.4595e-01, 3.3252e-01, 3.2642e-01, 3.1567e-01, 3.1250e-01,
                             2.9028e-01, 2.8564e-01, 2.7393e-01, 2.7295e-01, 2.6538e-01,
                             2.6465e-01, 2.6465e-01, 2.6440e-01, 2.6416e-01, 2.6416e-01,
                             2.5781e-01, 2.4951e-01, 2.4829e-01, 2.3792e-01, 2.3767e-01,
                             2.3743e-01, 2.3657e-01, 2.3401e-01, 2.3376e-01, 2.3279e-01,
                             2.3279e-01, 2.3145e-01, 2.2998e-01, 2.2961e-01, 2.2876e-01,
                             2.2839e-01, 2.2034e-01, 2.1619e-01, 2.1582e-01, 2.1436e-01,
                             2.0715e-01, 2.0557e-01, 2.0251e-01, 2.0154e-01, 2.0154e-01,
                             1.9922e-01, 1.9873e-01, 1.9763e-01, 1.8750e-01, 1.8726e-01,
                             1.8152e-01, 1.7944e-01, 1.7725e-01, 1.7676e-01, 1.7554e-01,
                             1.7517e-01, 1.7322e-01, 1.7175e-01, 1.6760e-01, 1.6748e-01,
                             1.6687e-01, 1.6650e-01, 1.6577e-01, 1.6040e-01, 1.5906e-01,
                             1.5906e-01, 1.5845e-01, 1.5759e-01, 1.5686e-01, 1.5649e-01,
                             1.5454e-01, 1.5234e-01, 1.5186e-01, 1.4758e-01, 1.4575e-01,
                             1.4197e-01, 1.4185e-01, 1.4136e-01, 1.3977e-01, 1.3965e-01,
                             1.3940e-01, 1.3586e-01, 1.3367e-01, 1.2830e-01, 1.2659e-01,
                             1.2598e-01, 1.2561e-01, 1.2463e-01, 1.2415e-01, 1.2366e-01,
                             1.2299e-01, 1.1755e-01, 1.1438e-01, 1.1438e-01, 1.1249e-01,
                             1.1108e-01, 1.0858e-01, 1.0791e-01, 1.0754e-01, 1.0614e-01,
                             1.0541e-01, 1.0382e-01, 1.0223e-01, 1.0065e-01, 9.9426e-02,
                             9.8389e-02, 9.8206e-02, 9.7168e-02, 9.3079e-02, 9.2896e-02,
                             9.2590e-02, 9.1125e-02, 9.0759e-02, 9.0393e-02, 8.7585e-02,
                             8.7219e-02, 8.6731e-02, 8.5815e-02, 8.5754e-02, 8.5693e-02,
                             8.4900e-02, 8.4473e-02, 8.3313e-02, 8.1177e-02, 8.0627e-02,
                             7.9956e-02, 7.7026e-02, 7.6233e-02, 7.6233e-02, 7.6050e-02,
                             7.5500e-02, 7.4707e-02, 7.4524e-02, 7.4463e-02, 7.1167e-02,
                             7.0312e-02, 6.6528e-02, 6.6284e-02, 0.0000e+00, 3.1328e+00,
                             0.0000e+00, 3.0670e-03, 0.0000e+00, 0.0000e+00, 0.0000e+00,
                             5.3344e+01, 5.3344e+01, 0.0000e+00, 3.0766e+01, 3.0094e+01,
                             2.8984e+01, 2.8656e+01, 2.8578e+01, 2.0203e+01, 1.7734e+01,
                             1.7391e+01, 1.7375e+01, 1.6625e+01, 1.6359e+01, 1.2969e+01,
                             1.1352e+01, 1.0219e+01, 9.5547e+00, 9.4531e+00, 8.8750e+00,
                             8.2812e+00, 8.0469e+00, 7.7422e+00, 7.6328e+00, 7.5664e+00,
                             7.2070e+00, 6.5742e+00, 6.0000e+00, 5.8008e+00, 5.3125e+00,
                             5.1602e+00, 4.6680e+00, 4.4570e+00, 4.1250e+00, 4.0508e+00,
                             0.0000e+00, 2.0703e+00, 2.0098e+00, 0.0000e+00, 3.1309e+00,
                             3.0703e+00, 9.4971e-01, 6.9031e-02, 0.0000e+00, 5.3320e-01,
                             2.0117e-01, 0.0000e+00, 2.3164e+00, 2.1758e+00, 0.0000e+00,
                             1.8027e+00, 0.0000e+00, 6.8789e+00, 3.3965e+00, 3.2734e+00,
                             3.2676e+00, 2.6777e+00, 2.6191e+00, 2.4922e+00, 2.3242e+00,
                             2.0996e+00, 2.0566e+00, 1.8262e+00, 1.8213e+00, 1.7266e+00,
                             1.7051e+00, 1.6621e+00, 1.6230e+00, 1.5527e+00, 1.5156e+00,
                             1.4404e+00, 1.2949e+00, 1.2686e+00, 1.2334e+00, 1.2314e+00,
                             1.1846e+00, 1.1738e+00, 1.1426e+00, 1.0938e+00, 1.0137e+00,
                             9.6143e-01, 9.3115e-01, 8.8721e-01, 8.4668e-01, 7.7246e-01,
                             7.1387e-01, 6.3330e-01, 6.1572e-01, 0.0000e+00, 1.5422e+01,
                             0.0000e+00, 7.3500e+01, 7.3500e+01, 7.3500e+01, 7.3500e+01,
                             7.3500e+01, 0.0000e+00, 3.9656e+01, 3.9281e+01, 3.9062e+01,
                             3.5406e+01, 3.4906e+01, 3.4000e+01, 2.0469e+01, 2.0109e+01,
                             2.0109e+01, 1.9953e+01, 1.9906e+01, 1.9891e+01, 1.8797e+01,
                             1.6531e+01, 1.6031e+01, 1.5383e+01, 1.4844e+01, 1.4664e+01,
                             1.4531e+01, 1.3688e+01, 1.3680e+01, 1.3445e+01, 1.3125e+01,
                             1.3125e+01, 1.2844e+01, 1.2500e+01, 1.2453e+01, 1.2086e+01,
                             1.1562e+01, 1.1000e+01, 1.0852e+01, 1.0766e+01, 1.0602e+01,
                             1.0547e+01, 1.0438e+01, 1.0297e+01, 1.0156e+01, 9.7812e+00,
                             9.7578e+00, 9.0781e+00, 8.9766e+00, 8.7188e+00, 8.5547e+00,
                             8.2031e+00, 7.9844e+00, 7.9297e+00, 7.8516e+00, 7.8281e+00,
                             7.7383e+00, 7.1953e+00, 6.9844e+00, 6.7930e+00, 6.7812e+00,
                             6.6016e+00, 6.4258e+00, 6.3906e+00, 6.3359e+00, 6.3125e+00,
                             6.1836e+00, 5.9844e+00, 5.8633e+00, 5.6562e+00, 5.6328e+00,
                             5.5898e+00, 5.5234e+00, 5.3320e+00, 5.0625e+00, 5.0117e+00,
                             4.5586e+00, 4.4766e+00, 4.4180e+00, 4.3906e+00, 4.1328e+00,
                             4.0117e+00, 3.9824e+00, 3.9492e+00, 3.7598e+00, 3.7129e+00,
                             3.6406e+00, 3.6270e+00, 0.0000e+00, 9.7198e-03, 0.0000e+00,
                             2.1680e+00, 0.0000e+00, 8.1562e+00, 3.8906e+00, 3.8281e+00,
                             3.3164e+00, 3.0801e+00, 3.0391e+00, 3.0234e+00, 3.0156e+00,
                             3.0000e+00, 2.9277e+00, 2.8164e+00, 2.6445e+00, 2.5938e+00,
                             2.5918e+00, 2.5820e+00, 2.5566e+00, 2.5000e+00, 2.4492e+00,
                             2.3379e+00, 2.1738e+00, 2.1738e+00, 2.0605e+00, 2.0273e+00,
                             1.9746e+00, 1.9414e+00, 1.9160e+00, 1.8896e+00, 1.8154e+00,
                             1.8125e+00, 1.7627e+00, 1.7627e+00, 1.7168e+00, 1.6318e+00,
                             1.6074e+00, 1.6035e+00, 1.5938e+00, 1.5928e+00, 1.5879e+00,
                             1.5605e+00, 1.5273e+00, 1.4951e+00, 1.4873e+00, 1.4668e+00,
                             1.4277e+00, 1.4004e+00, 1.3613e+00, 1.3398e+00, 1.2949e+00,
                             1.2861e+00, 1.2842e+00, 1.2559e+00, 1.2529e+00, 1.2500e+00,
                             1.2217e+00, 1.1924e+00, 1.1641e+00, 1.1406e+00, 1.1367e+00,
                             1.1299e+00, 1.0908e+00, 1.0713e+00, 1.0615e+00, 1.0332e+00,
                             1.0137e+00, 9.9316e-01, 9.8389e-01, 9.8291e-01, 9.7266e-01,
                             9.6777e-01, 9.4287e-01, 9.3164e-01, 9.3115e-01, 9.2432e-01,
                             8.8867e-01, 8.8281e-01, 8.7012e-01, 8.3936e-01, 7.9736e-01,
                             7.9541e-01, 7.7344e-01, 7.6270e-01, 7.3926e-01, 6.8701e-01,
                             6.5576e-01, 6.5186e-01, 6.4648e-01, 5.8691e-01, 5.7520e-01,
                             5.6641e-01, 5.6348e-01, 0.0000e+00, 2.4094e+01, 2.3734e+01,
                             2.1094e+01, 1.7500e+01, 1.5648e+01, 1.5367e+01, 1.1406e+01,
                             9.6562e+00, 8.7188e+00, 8.2656e+00, 0.0000e+00, 2.8078e+01,
                             2.3750e+01, 1.6703e+01, 1.3438e+01, 1.2570e+01, 9.6797e+00,
                             8.6094e+00, 7.6289e+00, 6.7930e+00, 6.4570e+00, 0.0000e+00,
                             3.8800e+02, 0.0000e+00, 5.2469e+01, 5.1562e+01, 3.5750e+01,
                             3.4875e+01, 3.4688e+01, 3.3469e+01, 2.8609e+01, 2.4469e+01,
                             2.3844e+01, 2.0391e+01, 1.3727e+01, 1.3359e+01, 1.1727e+01,
                             1.1242e+01, 1.0227e+01, 1.0055e+01, 0.0000e+00, 6.3789e+00,
                             5.4766e+00, 5.3945e+00, 5.3828e+00, 5.3594e+00, 5.1094e+00,
                             5.1055e+00, 4.2656e+00, 4.2539e+00, 4.2461e+00, 3.7676e+00,
                             3.0703e+00, 2.8340e+00, 2.4668e+00, 1.9268e+00, 1.7969e+00,
                             1.5488e+00, 1.5127e+00, 0.0000e+00, 4.3188e+01, 3.6469e+01,
                             0.0000e+00, 2.9047e+01, 2.8625e+01, 2.7078e+01, 2.6984e+01,
                             2.2047e+01, 0.0000e+00], dtype=np.float16)

    # maybe testing torsions?
    rep = bat("data/sdf/penicillin.sdf", bagger.bags, bagger.bag_sizes)
    assert np.all(np.abs(pen_bat_true - rep) <= 1e-4) == True


if __name__ == "__main__":
    print(
        "This is a test of the bat representation in chemreps to be evaluated with pytest"
    )
